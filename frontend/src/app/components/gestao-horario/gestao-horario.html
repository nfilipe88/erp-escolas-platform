<div class="p-6 max-w-7xl mx-auto bg-white shadow-xl rounded-xl border-t-8 border-purple-600">

  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-black text-gray-800">游늰 Gest칚o de Hor치rios</h1>

    <div class="flex gap-4">
      <select [(ngModel)]="turmaSelecionada" (change)="carregarGrade()" class="p-2 border rounded font-bold">
        <option [value]="0">-- Selecione a Turma --</option>
        @for (t of turmas; track t.id) {
          <option [value]="t.id">{{ t.nome }} ({{ t.turno }})</option>
        }
      </select>

      <button *ngIf="turmaSelecionada" (click)="gerarGrade()"
        class="bg-purple-100 text-purple-800 px-4 py-2 rounded font-bold hover:bg-purple-200 transition">
        丘뙖잺 Gerar Autom치tico
      </button>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-5 gap-4" *ngIf="grade.length > 0">
    @for (dia of diasSemana; track $index) {
      <div class="border rounded-lg bg-gray-50 overflow-hidden">
        <div class="bg-purple-900 text-white text-center py-2 font-bold uppercase text-sm">
          {{ dia }}
        </div>

        <div class="p-2 space-y-2">
          @for (slot of getSlotsPorDia($index); track slot.id) {
            <div (click)="abrirEdicao(slot)"
              class="bg-white p-3 rounded shadow border-l-4 cursor-pointer hover:shadow-md transition"
              [ngClass]="slot.disciplina_id ? 'border-green-500' : 'border-gray-300'">

              <div class="text-xs font-bold text-gray-500 mb-1">
                {{ slot.hora_inicio }} - {{ slot.hora_fim }}
              </div>

              <div class="font-black text-gray-800 text-sm truncate">
                {{ slot.disciplina_nome || '---' }}
              </div>

              <div class="text-xs text-gray-600 truncate">
                {{ slot.professor_nome || 'Sem Professor' }}
              </div>
            </div>
          }
        </div>
      </div>
    }
  </div>

  <div *ngIf="grade.length === 0 && turmaSelecionada" class="text-center py-10 text-gray-400">
    Sem hor치rio definido. Clique em "Gerar Autom치tico" para come칞ar.
  </div>

  <div *ngIf="slotEditando" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-lg p-6 w-96 shadow-2xl">
      <h3 class="font-bold text-lg mb-4">Editar Tempo de Aula</h3>
      <p class="text-sm text-gray-500 mb-4">{{ slotEditando.hora_inicio }} 맙 {{ slotEditando.hora_fim }}</p>

      <div class="mb-3">
        <label class="block text-xs font-bold uppercase text-gray-500">Disciplina</label>
        <select [(ngModel)]="editForm.disciplina_id" class="w-full p-2 border rounded">
          <option [value]="0">-- Vazio --</option>
          @for (d of disciplinas; track d.id) { <option [value]="d.id">{{ d.nome }}</option> }
        </select>
      </div>

      <div class="mb-6">
        <label class="block text-xs font-bold uppercase text-gray-500">Professor</label>
        <select [(ngModel)]="editForm.professor_id" class="w-full p-2 border rounded">
          <option [value]="0">-- Vazio --</option>
          @for (p of professores; track p.id) { <option [value]="p.id">{{ p.nome }}</option> }
        </select>
      </div>

      <div class="flex justify-end gap-2">
        <button (click)="slotEditando = null" class="text-gray-500 px-4 py-2 hover:bg-gray-100 rounded">Cancelar</button>
        <button (click)="salvarSlot()" class="bg-purple-900 text-white px-4 py-2 rounded font-bold">Salvar</button>
      </div>
    </div>
  </div>

</div>
